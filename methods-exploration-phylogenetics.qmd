---
title: "Methods Exploration: Phylogenetics in R"
author: "John Hinkle"
format: html
editor: visual
self-contained: true
---

## Load packages

```{r}
library(adegenet)
library(ggtree)
```

## Load FASTA file

```{r}
seqs <- fasta2DNAbin("./data/usflu.fasta")
```

## Load annotation data

```{r}
library(tidyverse)
a <- read_csv("./data/usflu.annot.csv")
head(a)
```

## Wrangle annotation data

```{r}
a <- a |>
  mutate(state = str_extract(misc, "(?<=/)[^/]+(?=/)")) |>
  mutate(state = ifelse(state == "Memphis", "Tennessee", state)) |>
  select(-`...1`, -misc)
head(a)
```

## Pairwise distances

```{r}
library(ape)
dist <- dist.dna(seqs, model = "K80")
```

## Create tree object

```{r}
t <- bionj(dist)
```

## Plot tree

```{r}
plot(t, cex = 0.6)
```

## X

```{r}

```
